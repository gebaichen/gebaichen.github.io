import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.b6PMUn9J.js";const u=JSON.parse('{"title":"Flask-Assets","description":"使用Flask-Assets实行JavaScript、css代码打包","frontmatter":{"date":"2023.9.1","title":"Flask-Assets","tags":["flask","flask-assets","python","web","flask插件"],"description":"使用Flask-Assets实行JavaScript、css代码打包","link":"/flask/flask-assets.html"},"headers":[],"relativePath":"flask/flask-assets.md","filePath":"flask/flask-assets.md","lastUpdated":1700227085000}'),p={name:"flask/flask-assets.md"},e=l(`<h1 id="flask-assets" tabindex="-1">Flask-Assets <a class="header-anchor" href="#flask-assets" aria-label="Permalink to &quot;Flask-Assets&quot;">​</a></h1><p>将 Web 资产库与 Flask 集成，增加了对合并、缩小和编译 CSS 和 Javascript 文件的支持。</p><blockquote><p><a href="https://flask-assets.readthedocs.io/en/latest/" target="_blank" rel="noreferrer">https://flask-assets.readthedocs.io/en/latest/</a></p></blockquote><h2 id="使用的目的" tabindex="-1">使用的目的 <a class="header-anchor" href="#使用的目的" aria-label="Permalink to &quot;使用的目的&quot;">​</a></h2><p>在项目部署完成运行的时候，并发高了，可能就会把你的小服务器内存整崩了 为了优化项目，所以我们要把js、css合并缩小编译，可以让文件内存变小，让前端爬虫 看不懂js代码，从而做到反爬功能</p><h2 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h2><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-i8d_h" id="tab-yGIJ6Qe" checked="checked"><label for="tab-yGIJ6Qe">pip</label><input type="radio" name="group-i8d_h" id="tab-2qfmCDH"><label for="tab-2qfmCDH">poetry</label></div><div class="blocks"><div class="language-shell vp-adaptive-theme active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">pip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Flask-Assets</span></span>
<span class="line"><span style="color:#B392F0;">pip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cssmin</span></span>
<span class="line"><span style="color:#B392F0;">pip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">jsmin</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">pip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Flask-Assets</span></span>
<span class="line"><span style="color:#6F42C1;">pip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cssmin</span></span>
<span class="line"><span style="color:#6F42C1;">pip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">jsmin</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">poetry</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">add</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Flask-Assets</span></span>
<span class="line"><span style="color:#B392F0;">poetry</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">add</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cssmin</span></span>
<span class="line"><span style="color:#B392F0;">poetry</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">add</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">jsmin</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">poetry</span><span style="color:#24292E;"> </span><span style="color:#032F62;">add</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Flask-Assets</span></span>
<span class="line"><span style="color:#6F42C1;">poetry</span><span style="color:#24292E;"> </span><span style="color:#032F62;">add</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cssmin</span></span>
<span class="line"><span style="color:#6F42C1;">poetry</span><span style="color:#24292E;"> </span><span style="color:#032F62;">add</span><span style="color:#24292E;"> </span><span style="color:#032F62;">jsmin</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div></div><h2 id="使用" tabindex="-1">使用 <a class="header-anchor" href="#使用" aria-label="Permalink to &quot;使用&quot;">​</a></h2><p>您可以通过创建 Environment 实例并以所谓的捆绑包的形式向其注册资产来初始化应用程序</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> Flask</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask_assets </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> Environment, Bundle</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">app </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Flask(</span><span style="color:#79B8FF;">__name__</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">assets </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Environment(app)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">js </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bundle(</span><span style="color:#9ECBFF;">&#39;jquery.js&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;base.js&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;widgets.js&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">filters</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;jsmin&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">output</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;dist/packed.js&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">assets.register(</span><span style="color:#9ECBFF;">&#39;js_all&#39;</span><span style="color:#E1E4E8;">, js)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> Flask</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask_assets </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> Environment, Bundle</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">app </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Flask(</span><span style="color:#005CC5;">__name__</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">assets </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Environment(app)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">js </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bundle(</span><span style="color:#032F62;">&#39;jquery.js&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;base.js&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;widgets.js&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">filters</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;jsmin&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">output</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;dist/packed.js&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">assets.register(</span><span style="color:#032F62;">&#39;js_all&#39;</span><span style="color:#24292E;">, js)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>分发包由任意数量的源文件（也可能包含其他嵌套分发包）、输出目标和要应用的过滤器列表组成。</p><p>所有路径都相对于应用的静态目录或 Flask 蓝图的静态目录。</p><p>如果您愿意，当然也可以在外部配置文件中定义您的资产，并从那里读取它们。 webassets 包括一些流行格式（如 YAML）的许多帮助程序类。</p><p>与 Flask 扩展的常见情况一样，Flask-Asssets 实例可以通过调用初始化 <code>init_app</code> 来与多个应用程序一起使用，而不是传递固定的应用程序对象：</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">app </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Flask(</span><span style="color:#79B8FF;">__name__</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">assets </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> flask_assets.Environment()</span></span>
<span class="line"><span style="color:#E1E4E8;">assets.init_app(app)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">app </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Flask(</span><span style="color:#005CC5;">__name__</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">assets </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> flask_assets.Environment()</span></span>
<span class="line"><span style="color:#24292E;">assets.init_app(app)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="使用捆绑包" tabindex="-1">使用捆绑包 <a class="header-anchor" href="#使用捆绑包" aria-label="Permalink to &quot;使用捆绑包&quot;">​</a></h2><p>现在，正确定义完成后，您希望合并和缩小它们，并在网页中包含指向压缩结果的链接：</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{% assets &quot;js_all&quot; %}</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">type</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;text/javascript&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">src</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;{{ ASSET_URL }}&quot;</span><span style="color:#E1E4E8;">&gt;&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">{% endassets %}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{% assets &quot;js_all&quot; %}</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">type</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;text/javascript&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">src</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;{{ ASSET_URL }}&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">{% endassets %}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>就是这样，真的。Flask-Assets 将在首次渲染模板时自动合并和压缩捆绑包的源文件，并在每次源文件更改时自动更新压缩文件。如果在应用配置中设置为 <code>ASSETS_DEBUG=True</code> ，则每个源文件将单独输出。</p><p>在开发模式中可以设置<code>ASSETS_DEBUG=True</code>，<strong>因为在实际开发中，我们要不断的修改css、 js文件</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">app.config[</span><span style="color:#9ECBFF;">&#39;ASSETS_DEBUG&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">True</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">app.config[</span><span style="color:#032F62;">&#39;ASSETS_DEBUG&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">True</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,21),o=[e];function t(r,c,i,E,y,d){return a(),n("div",null,o)}const b=s(p,[["render",t]]);export{u as __pageData,b as default};
